(function(e){function t(t){for(var n,o,a=t[0],c=t[1],l=t[2],f=0,d=[];f<a.length;f++)o=a[f],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,a=1;a<i.length;a++){var c=i[a];0!==r[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},r={main:0},s=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/zuweiser/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;s.push(["8dc6","chunk-vendors"]),i()})({0:function(e,t){},1:function(e,t){},"13f6":function(e,t,i){"use strict";var n=i("7660"),r=i.n(n);r.a},2:function(e,t){},"41b4":function(e,t,i){},7589:function(e,t,i){"use strict";var n=i("41b4"),r=i.n(n);r.a},7660:function(e,t,i){},"8dc6":function(e,t,i){"use strict";i.r(t);i("ab8b");var n=i("2b0e"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Zuweiser")},s=[],o=i("9ab4"),a=i("60a3"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",{staticClass:"row"},[i("am-excel-reader",{staticClass:"col-md-12",on:{"excel-overview-loaded":e.onOverviewLoaded}})],1),e.excelOverview?i("div",{staticClass:"row"},[i("h2",{staticClass:"col-md-12"},[e._v("Blätter & Spalten auswählen")]),i("am-activities-sheet-config",{staticClass:"col-md-6",attrs:{"excel-overview":e.excelOverview},on:{completed:e.activitiesConfigCompleted}}),i("am-participants-sheet-config",{staticClass:"col-md-6",attrs:{"excel-overview":e.excelOverview},on:{completed:e.participantsConfigCompleted}})],1):e._e(),i("div",{staticClass:"row"},[i("am-do-matching",{staticClass:"col-md-12",attrs:{config:e.matchConfig},on:{matched:e.onMatched}})],1),i("div",{staticClass:"row"},[i("am-result-printer",{staticClass:"col-md-12",attrs:{result:e.result}})],1)])},l=[],u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v("Aktivitäten")]),i("h4",[e._v("Arbeitsblatt")]),i("am-multiselect",{attrs:{values:Object.keys(e.excelOverview.sheets)},on:{input:e.onChange},model:{value:e.activitiesConfig.worksheet,callback:function(t){e.$set(e.activitiesConfig,"worksheet",t)},expression:"activitiesConfig.worksheet"}}),i("h4",[e._v("Spalten")]),e._l(e.activitiesConfig.fields,function(t,n){return e.activitiesConfig.worksheet?i("am-multiselect",{key:t.id,attrs:{values:e.excelOverview.sheets[e.activitiesConfig.worksheet],label:e.labels[n]},on:{input:e.onChange},model:{value:e.activitiesConfig.fields[n],callback:function(t){e.$set(e.activitiesConfig.fields,n,t)},expression:"activitiesConfig.fields[key]"}}):e._e()})],2)},f=[],d={props:["excelOverview"],data(){return{activitiesConfig:{worksheet:"",fields:{id:"",name:"",limit:""}},labels:{worksheet:"Arbeitsblatt",id:"ID",name:"Kursname",limit:"Teilnehmerlimite"}}},methods:{onChange(){this.activitiesConfig.worksheet&&this.$emit("completed",this.activitiesConfig)}}},h=d,p=i("2877"),v=Object(p["a"])(h,u,f,!1,null,"156cd496",null),m=v.exports,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h2",[e._v("Datei angeben")]),i("label",{attrs:{for:"file"}}),i("input",{attrs:{type:"file",id:"file"},on:{change:e.loadExcel}}),e._t("default")],2)},_=[],b=i("2ef0"),w=i("1146"),y=i.n(w);function C(e,t){var i=e.Sheets[t];k(i);return O(i)}function k(e){var t=y.a.utils.sheet_to_json(e);return Object.keys(t[0])}function O(e){return y.a.utils.sheet_to_json(e)}function x(e){var t=new FileReader,i=new Promise(function(e,i){t.onload=function(t){var n=t.target.result;try{var r=y.a.read(n,{type:"binary"});e(r)}catch(t){i(t)}}});return t.readAsBinaryString(e),i}function j(e){for(var t={},i=0,n=e.SheetNames;i<n.length;i++){var r=n[i],s=y.a.utils.sheet_to_json(e.Sheets[r]);t[r]=Object.keys(s[0])}return{sheets:t}}var P=function(){function e(e){this.courseData=e,this.students=[],this.shadows=[]}return Object.defineProperty(e.prototype,"id",{get:function(){return this.courseData.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"limit",{get:function(){return this.courseData.limit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.courseData.name},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.name},e}(),S=function(){function e(e){this.studentData=e,this.matched=!1}return Object.defineProperty(e.prototype,"id",{get:function(){return this.studentData.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"priorities",{get:function(){return this.studentData.priorities},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.studentData.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstName",{get:function(){return this.studentData.firstName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"class",{get:function(){return this.studentData.class},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.firstName+" "+this.name},e}();function $(e,t){var i={};return b["forOwn"](t,function(t,n){b["isString"](t)?i[n]=e[t]:b["isArray"](t)&&(i[n]=[],b["forOwn"](t,function(t,r){i[n].push(e[t.column])}))}),i}function A(e,t){var i=$(e,t);return new S(i)}function E(e,t){var i=$(e,t);return new P(i)}var N=function(e){function t(i,n,r){void 0===r&&(r={});var s=e.call(this,n+" not unique for entity "+i)||this;return Object.setPrototypeOf(s,t.prototype),s.entityType=i,s.propertyName=n,s.entity=r,s}return o["b"](t,e),t}(Error),D=function(e){function t(i,n,r){void 0===r&&(r={});var s=e.call(this,i+" with id="+n+" does not exist. Referred to by "+r+".")||this;return Object.setPrototypeOf(s,t.prototype),s.entityType=i,s.id=n,s.referrer=r,s}return o["b"](t,e),t}(Error);function M(e){var t=e.students,i=e.courses;z(i),T(t),R(t,i),B(t);var n=0,r=t[0].priorities.length;while(n<r)t.forEach(function(e){var t=e.priorities[n],r=b["find"](i,function(e){return e.id===t}),s=r.students.length<r.limit;!e.matched&&s?(r.students.push(e),e.matched=!0):r.shadows.push({student:e,wasCourseFull:!s,wasAlreadyMatched:e.matched,priority:n+1})}),n+=1;return{students:t,courses:i}}function T(e){var t=new Set;e.forEach(function(e){if(t.has(e.id))throw new N("Participant","id",new S({}));t.add(e.id)})}function z(e){var t=new Set;e.forEach(function(e){if(t.has(e.id))throw new N("Activity","id",new P({}));t.add(e.id)})}function B(e){e.forEach(function(e){var t=e.priorities.length,i=b["uniq"](e.priorities).length;if(t!==i)throw new N("Participant","priorities",e)})}function R(e,t){var i=t.map(function(e){return e.id});e.forEach(function(e){e.priorities.forEach(function(t){if(!b["find"](i,function(e){return e===t}))throw new D("Activity",t,e)})})}function F(e){var t=e.workbook,i=e.config,n=C(t,i.courses.worksheet),r=n.map(function(e){return E(e,i.courses.fields)});return{courses:r,workbook:t,config:i}}function I(e){var t=e.workbook,i=e.courses,n=e.config,r=C(t,n.student.worksheet),s=r.map(function(e){return A(e,n.student.fields)}),o=b["shuffle"](s);return{workbook:t,students:o,courses:i,config:n}}var K={data(){return{filename:"",error:{message:""}}},methods:{loadExcel(e){const t=e.target.files[0];x(t).then(j).then(e=>{return e.filename=t,e}).then(e=>this.$emit("excel-overview-loaded",e)).catch(e=>this.error.message=e.toString())}}},q=K,J=Object(p["a"])(q,g,_,!1,null,null,null),L=J.exports,U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h3",[e._v("Teilnehmer")]),i("h4",[e._v("Arbeitsblatt")]),i("am-multiselect",{attrs:{values:Object.keys(e.excelOverview.sheets)},on:{input:e.onChange},model:{value:e.participantsConfig.worksheet,callback:function(t){e.$set(e.participantsConfig,"worksheet",t)},expression:"participantsConfig.worksheet"}}),i("h4",[e._v("Spalten")]),e._l(e.notPriorities(e.participantsConfig.fields),function(t,n){return e.participantsConfig.worksheet?i("am-multiselect",{key:t.id,attrs:{values:e.excelOverview.sheets[e.participantsConfig.worksheet],label:e.labels[n]},on:{input:e.onChange},model:{value:e.participantsConfig.fields[n],callback:function(t){e.$set(e.participantsConfig.fields,n,t)},expression:"participantsConfig.fields[key]"}}):e._e()}),e._l(e.participantsConfig.fields.priorities,function(t,n){return e.participantsConfig.worksheet?i("div",[i("label",[e._v(e._s(n+1+". "+e.labels["priorities"]))]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.participantsConfig.fields.priorities[n].column,expression:"participantsConfig.fields.priorities[index].column"}],on:{input:e.onChange,change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.participantsConfig.fields.priorities[n],"column",t.target.multiple?i:i[0])}}},e._l(e.excelOverview.sheets[e.participantsConfig.worksheet],function(t){return i("option",[e._v("\n                "+e._s(t)+"\n            ")])}),0),i("button",{on:{click:function(t){return e.removePriority(n)}}},[e._v("-")])]):e._e()}),i("button",{on:{click:function(t){return e.addPriority()}}},[e._v("Priorität hinzufügen")])],2)},W=[],Z={props:["excelOverview"],data(){return{participantsConfig:{worksheet:"",fields:{id:"",name:"",firstName:"",class:"",priorities:[{column:null},{column:null},{column:null}]}},labels:{worksheet:"Arbeitsblatt",id:"ID",name:"Name",firstName:"Vorname",class:"Klasse",priorities:"Priorität"}}},methods:{onChange(){this.participantsConfig.worksheet&&this.$emit("completed",this.participantsConfig)},notPriorities(){return b["pickBy"](this.participantsConfig.fields,(e,t)=>"priorities"!==t)},removePriority(e){this.participantsConfig.fields.priorities.splice(e,1)},addPriority(){this.participantsConfig.fields.priorities.push({column:null})}}},G=Z,V=Object(p["a"])(G,U,W,!1,null,null,null),H=V.exports,Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("p",{staticStyle:{color:"red"}},[e._v(e._s(e.errorMessage))]),e.config.student&&e.config.courses?i("button",{on:{click:e.matchAndWrite}},[e._v("Prioritäten auflösen")]):e._e()])},X=[];function Y(e){if(e instanceof D)return`Teilnehmer '${e.referrer}' verweist auf nicht-existierende Aktivität mit id='${e.id}'`;if(e instanceof N)switch(e.propertyName){case"priorities":return`Prioritäten von '${e.entity.toString()}' sind nicht eindeutig.`;case"id":return`IDs der ${ee(e.entity)} sind nicht eindeutig.`;default:break}return`Keine Übersetzung für Fehler: ${e}`}function ee(e){return e instanceof S?"Teilnehmer":"Aktivitäten"}var te={props:["config"],data(){return{errorMessage:""}},methods:{matchAndWrite(){this.errorMessage="",x(this.config.filename).then(e=>{return{workbook:e,config:this.config}}).then(F).then(I).then(M).then(e=>this.$emit("matched",e)).catch(e=>{this.errorMessage=Y(e)})}}},ie=te,ne=Object(p["a"])(ie,Q,X,!1,null,null,null),re=ne.exports,se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.label?i("label",[e._v(e._s(e.label))]):e._e(),i("select",{on:{input:e.onSelected}},[i("option",[e._v("Bitte auswählen")]),e._l(e.values,function(t){return i("option",[e._v(e._s(t))])})],2)])},oe=[],ae={props:["config-item","values","value","label"],methods:{onSelected(e){this.$emit("input",e.target.value)}}},ce=ae,le=Object(p["a"])(ce,se,oe,!1,null,null,null),ue=le.exports,fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.result.courses?i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("h2",[e._v("Resultat")]),i("label",{attrs:{for:"printShadows"}},[e._v("Schattenteilnehmer anzeigen")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.printShadows,expression:"printShadows"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.printShadows)?e._i(e.printShadows,null)>-1:e.printShadows},on:{change:function(t){var i=e.printShadows,n=t.target,r=!!n.checked;if(Array.isArray(i)){var s=null,o=e._i(i,s);n.checked?o<0&&(e.printShadows=i.concat([s])):o>-1&&(e.printShadows=i.slice(0,o).concat(i.slice(o+1)))}else e.printShadows=r}}})])]),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6"},[i("ul",e._l(e.result.courses,function(t){return i("li",[i("h3",[e._v(e._s(t.name))]),i("table",[e._m(0,!0),i("tbody",e._l(t.students,function(n){return i("tr",[i("td",[e._v(e._s(n.firstName))]),i("td",[e._v(e._s(n.name))]),i("td",[e._v(e._s(n.class))]),i("td",[e._v(e._s(n.priorities.indexOf(t.id)+1))])])}),0)]),e.printShadows?[i("h4",[e._v("Schattenteilnehmer")]),i("table",[e._m(1,!0),i("tbody",e._l(t.shadows,function(t){return i("tr",[i("td",[e._v(e._s(t.student.firstName))]),i("td",[e._v(e._s(t.student.name))]),i("td",[e._v(e._s(t.student.class))]),i("td",[e._v(e._s(t.priority))]),i("td",[e._v(e._s(e.getReason(t)))])])}),0)])]:e._e()],2)}),0)]),i("div",{staticClass:"col-md-6"},[i("h3",[e._v("Nicht-zuweisbare Teilnehmer")]),i("table",[i("thead",[i("th"),i("th"),i("th"),e._l(e.numberOfPriorities(e.result.students),function(t){return i("th",[e._v("Priorität "+e._s(t))])})],2),i("tbody",e._l(e.findUnmatched(e.result.students),function(t){return i("tr",[i("td",[e._v(e._s(t.firstName))]),i("td",[e._v(e._s(t.name))]),i("td",[e._v(e._s(t.class))]),e._l(t.priorities,function(t){return i("td",[e._v(e._s(t))])})],2)}),0)])])])]):e._e()},de=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("thead",[i("th"),i("th"),i("th"),i("th",[e._v("Priorität")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("thead",[i("th"),i("th"),i("th"),i("th",[e._v("Priorität")]),i("th",[e._v("Grund")])])}],he={props:["result"],data(){return{printShadows:!1}},methods:{findUnmatched(e){return b["filter"](e,e=>!e.matched)},numberOfPriorities(e){return b["range"](1,e[0].priorities.length+1)},getReason(e){const t=[];return e.wasAlreadyMatched?t.push("Bereits zugewiesen"):e.wasCourseFull&&t.push("Aktivität voll"),t.join(", ")}}},pe=he,ve=(i("7589"),Object(p["a"])(pe,fe,de,!1,null,"33d58279",null)),me=ve.exports;n["a"].component("am-multiselect",ue);var ge={data(){return{excelOverview:null,matchConfig:{filename:null,courses:null,student:null},result:{courses:null}}},components:{"am-excel-reader":L,"am-activities-sheet-config":m,"am-participants-sheet-config":H,"am-do-matching":re,"am-result-printer":me},methods:{onOverviewLoaded(e){this.excelOverview=e,this.matchConfig.filename=e.filename},activitiesConfigCompleted(e){this.matchConfig.courses=e},participantsConfigCompleted(e){this.matchConfig.student=e},onMatched(e){this.result=e}}},_e=ge,be=(i("94c7"),Object(p["a"])(_e,c,l,!1,null,null,null)),we=be.exports,ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o["b"](t,e),t=o["a"]([Object(a["a"])({components:{Zuweiser:we}})],t),t}(a["b"]),Ce=ye,ke=Ce,Oe=(i("13f6"),Object(p["a"])(ke,r,s,!1,null,null,null)),xe=Oe.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(xe)}}).$mount("#app")},"94c7":function(e,t,i){"use strict";var n=i("a6ce"),r=i.n(n);r.a},a6ce:function(e,t,i){}});
//# sourceMappingURL=main.75f6d483.js.map